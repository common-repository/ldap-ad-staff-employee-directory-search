var globalData=null,website_url=mo_ldap_ds_search_data.site_url,noUserPerRow=1;const stringForNoData="Not Available",custom_styling=mo_ldap_ds_search_data.mo_ldap_ds_styling_array;var listDefault=website_url+"/wp-content/plugins/ldap-ad-staff-employee-directory-search/includes/images/icons8-menu-100-grey.png",gridDefault=website_url+"/wp-content/plugins/ldap-ad-staff-employee-directory-search/includes/images/icons8-grid-100.png";const defaultPic=website_url+"/wp-content/plugins/ldap-ad-staff-employee-directory-search/includes/images/userPicDefault.jpg";function showSelectedView(e){"list"==e?(listDefault=website_url+"/wp-content/plugins/ldap-ad-staff-employee-directory-search/includes/images/icons8-menu-100.png",gridDefault=website_url+"/wp-content/plugins/ldap-ad-staff-employee-directory-search/includes/images/icons8-grid-100-grey.png"):(gridDefault=website_url+"/wp-content/plugins/ldap-ad-staff-employee-directory-search/includes/images/icons8-grid-100.png",listDefault=website_url+"/wp-content/plugins/ldap-ad-staff-employee-directory-search/includes/images/icons8-menu-100-grey.png")}jQuery(document).ready(function(e){var a;function r(a,r,t){e.ajax({url:a,data:{action:"dir_search_fetch_records",selectValue:r,searchValue:t},success:function(e){let a=document.getElementById("dirsearchbutton");a&&(a.disabled=!1,a.classList.remove("mo_ldap_dir_search_button-loader"),document.getElementById("dirsearchbutton").textContent="Search"),i(e=JSON.parse(e))},error:function(e){}})}function i(a){var r=e("#moldapdirsearchappendppoint");r.empty();var i='<div class="mo-dir-result-table" id="mo-dir-result-table">';if(0!=t(r,a,typeof a,i))return;var s=0,d="",n=-1,c="",p=[];for(var u in a){if(s+=1,n+=1,a.hasOwnProperty(u)){var m=a[u];for(var h in m)if(0==h.localeCompare("mo_ldap_photo")){if(0==m[h].localeCompare("none"))var v='<p ><img class="mo_dir_search_profile_picture" id="mo_dir_search_profile_picture" src="'+defaultPic+'" ></p>';else var v='<p ><img class="mo_dir_search_profile_picture" id="mo_dir_search_profile_picture" src="data:image/jpeg;base64,'+m[h]+'" ></p>';d='<table><tr><td style="width: 40%;vertical-align:top;border:none;">'+v+'</td><td style="width: 59%;padding: 14px 10px 14px 0;border:none">'}else d+=c=0==m[h].localeCompare("nodata")?'<p class="mo_dir_search_user_data_para"><span class="mo_dir_search_user_data_label">'+h+"</span> : "+stringForNoData+"</p>":'<p class="mo_dir_search_user_data_para"><span class="mo_dir_search_user_data_label">'+h+"</span> : "+m[h]+"</p>"}p[n]=d+"</td></tr></table>",d=""}let g=p.length;for(var f=l("grid"),b=1;b<=g;b++)b%noUserPerRow==1&&(f='<div id="result_row" >'),f=f+'<div class="mo_dir_search_user_data" id="mo_dir_search_user_data">'+p[b-1]+"</div>",(b%noUserPerRow==0||b==g)&&(f+="",i+=f,f="");f+="</div>",i+="</div><div></div><br><br><br></div>",r.append(i),o(a,"grid");let y=Object.values(custom_styling);var w=y[0],$=y[1];y[2];let _=document.querySelectorAll(".mo_dir_search_user_data_para"),x=document.querySelectorAll(".mo_dir_search_user_data");x.forEach(e=>{e.style.background=w}),_.forEach(e=>{e.style.color=$})}function t(e,a,r,i){if(0==r.localeCompare("string")){if(0==a.localeCompare("no_records_found"))return i+='<br><br><h4 style="text-align: center;" >No Records Found.</h4></div>',e.append(i),1;if(0==a.localeCompare("no_request"))return i+='<br><br><h4 style="text-align: center;" >Click on Search to fetch Records.</h4></div>',e.append(i),1;if(0==a.localeCompare("ldap_extension_is_not_installed"))return i+='<br><br><h4 style="text-align: center;" ><a style="color:#0000ff;" target="_blank" href="https://faq.miniorange.com/knowledgebase/how-to-enable-php-ldap-extension/">PHP LDAP extension</a> is not installed or disabled. Please enable it.</h4></div>',e.append(i),1;else if(0==a.localeCompare("connection_error"))return i+='<br><br><h4 style="text-align: center;" >Unable to connect to LDAP server. Please check your connection configuration and try again</h4></div>',e.append(i),1;else if(0==a.localeCompare("search_base_error"))return i+='<br><br><h4 style="text-align: center;" >Invalid Search Base Configuration : Please Verify and Correct the Search Base Configuration </h4></div>',e.append(i),1}return 0}function l(e){showSelectedView(e);var a='<div style="display:flex;justify-content:end;border-bottom:1px solid #ccc"><div>';return a+='<div id="mo_ldap_dir_search_view_options_container" class="mo_ldap_dir_search_view_option_container"><div class="list-view-button align-list-view-button" id="list" ><img src="'+listDefault+'" width= "25px" height= "25px" alt="grid" id="list-icon"></div>',a+='<div id="grid" style="display: flex; align-items: center" class="grid-view-button align-list-view-button"><img src="'+gridDefault+'" width= "25px" height= "25px" alt="grid" id="grid-icon"></div>',a+='</div></div></div> <div style="overflow-x: auto;"><div class="mo_ldap_dir_search_responsive_container">'}function s(a,r){"list"==a?function a(r){var i=e("#moldapdirsearchappendppoint");i.empty();var s='<div class="mo-dir-result-table" id="mo-dir-result-table">';if(0==t(i,r,typeof r,s)){var d=0,n="",c=-1,p="",u=[];for(var m in s+='<div class="mosl_mg_overflow_container" style="height: 100%;">',r){if(d+=1,c+=1,n+='<div class="mosl_mg_active_wp_user_row">',r.hasOwnProperty(m)){var h=r[m],v='<div class="mo_dir_search_result_row" id="mo_dir_search_user_data"><div class="mosl_mg_active_wp_user_row">';for(var g in h)if(0==g.localeCompare("mo_ldap_photo"))continue;for(var g in h)if(0==g.localeCompare("mo_ldap_photo"))n+='<div class="mosl_mg_active_wp_user_row_column_1"><div class="mo_ldap_dir_search_user_image_container">',0==h[g].localeCompare("none")?n+='<img src="'+defaultPic+'" height="45px" width="45px" alt=""></div>':n+='<img src="data:image/jpeg;base64,'+h[g]+'" height="45px" width="45px" alt=""></div>';else{var f=0==g.localeCompare("Name")?"":" mo_dir_search_list_coloumn";p=0==h[g].localeCompare("nodata")?'<div class="mo_dir_search_user_data_para'+f+'">'+stringForNoData+"</div>":'<div class="mo_dir_search_user_data_para'+f+'">'+h[g]+"</div>",0==g.localeCompare("Name")?(p+="</div>",v+='<div class="mo_dir_search_list_coloumn mo_dir_search_list_coloumn_headings mo_dir_search_user_data_para" >'+g+"</div>"):v+='<div class="mo_dir_search_list_coloumn mo_dir_search_list_coloumn_headings mo_dir_search_user_data_para">'+g+"</div>",n+=p}v+="</div></div>",u[c]=n+"</div>",n=""}let b=u.length;var y=l("list");y+=v;for(var w=1;w<=b;w++)y=y+'<div class="mo_dir_search_result_row" id="mo_dir_search_user_data">'+u[w-1]+"</div>";y+="</div>"}s+=y,s+="</div><div></div><br><br><br></div>",i.append(s),o(r,"list")}}(r):i(r)}function o(e,a){let r=document.getElementById("list"),i=document.getElementById("grid");r.addEventListener("click",function(){showSelectedView(a),s("list",e)}),i.addEventListener("click",function(){showSelectedView(a),s("grid",e)})}e("#dirsearchbutton").click(function a(){!function e(){let a=document.getElementById("dirsearchbutton");a.disabled=!0,a.textContent="",a.classList.add("mo_ldap_dir_search_button-loader")}(),setTimeout(()=>{!function e(){let a=document.getElementById("dirsearchbutton");a.classList.remove("mo_ldap_dir_search_button-loader"),a.textContent="Search",a.disabled=!1}()},3e4);var i=e("#ajaxcallurl").val(),t=e("#modirsearchfield").val(),l=e("#modirsearchstring").val();r(i,t,l)}),r(a=e("#ajaxcallurl").val(),"mo_ldap_default_call","mo_ldap_default_call")});